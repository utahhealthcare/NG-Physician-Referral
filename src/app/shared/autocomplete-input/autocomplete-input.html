<div class="gls-margin">
  <label class="gls-form-label" [for]="inputId">{{ labelId }}</label>
  <div class="gls-form-controls auto">
    <input
      type="text"
      class="gls-input"
      [id]="inputId"
      [formControl]="ctrl"
      [attr.placeholder]="placeholder"
      [attr.aria-label]="ariaLabel"
      [attr.aria-labelledby]="labelId || null"
      (focus)="onFocus()"
      (blur)="onBlur()"
      (keydown)="keydown($event)"
      autocomplete="off"
      role="combobox"
      [attr.aria-expanded]="open"
      aria-autocomplete="list"
      [attr.aria-controls]="'listbox-' + mode"
      [attr.aria-activedescendant]="open && highlighted >= 0 ? 'option-' + highlighted : null"
    />

    @if (hasValue) {
      <button
        type="button"
        class="clear-btn"
        aria-label="Clear"
        title="Clear"
        (pointerdown)="$event.preventDefault()"
        (click)="clear()"
      >
        <!-- Accessible “X” icon -->
        <svg viewBox="0 0 20 20" width="16" height="16" aria-hidden="true" focusable="false">
          <path d="M5.3 5.3a1 1 0 0 1 1.4 0L10 8.6l3.3-3.3a1 1 0 0 1 1.4 1.4L11.4 10l3.3 3.3a1 1 0 0 1-1.4 1.4L10 11.4l-3.3 3.3a1 1 0 1 1-1.4-1.4L8.6 10 5.3 6.7a1 1 0 0 1 0-1.4Z"/>
        </svg>
        <span class="sr-only">Clear</span>
      </button>
    }

    @if (open) {
      <ul class="auto-panel" role="listbox" [id]="'listbox-' + mode">
        @for (s of suggestions; track s.id; let i = $index) {
          <li
            class="option"
            role="option"
            [id]="'option-' + i"
            [attr.aria-selected]="i === highlighted"
            [class.active]="i === highlighted"
          >
            <button type="button" (mousedown)="choose(s)">
              <span class="label" [innerHTML]="s.htmlLabel"></span>
            </button>
          </li>
        }
      </ul>
    }
  </div>
</div>